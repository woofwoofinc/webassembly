.. _dev:

Development Tools Container
===========================
The project source comes with a ``dev`` directory which contains a script for
building a rkt Ubuntu container with useful development tools.

To build this you must have a system with an installation of rkt and buildah.
For macOS, the RktMachine_ project provides an xhyve-based VM running CoreOS
with installations of rkt, buildah, docker2aci, and other useful container
tools.

.. _RktMachine: https://github.com/woofwoofinc/rktmachine


Building
--------
Build the container using the provided build script:

::

    ./dev-webassembly.buildah.sh

This will make a ``dev-webassembly.oci`` in the directory. Convert this to
``dev-webassembly.aci`` for installation into rkt:

::

    docker2aci dev-webassembly.oci
    mv dev-webassembly-latest.aci dev-webassembly.aci

.. NOTE::
   The conversion may require the docker2aci version from
   `github.com/woofwoofinc/docker2aci`_ which has support for recent OCI
   container formats generated by buildah.

.. _github.com/woofwoofinc/docker2aci: https://github.com/woofwoofinc/docker2aci

Install this into rkt:

::

    rkt --insecure-options=image fetch ./dev-webassembly.aci

This container is intended for interactive use, so to run it with rkt use:

::

    sudo rkt run \
        --interactive \
        --port=8080:8080 \
        --volume webassembly,kind=host,source=$(pwd) \
        dev-webassembly \
        --mount volume=webassembly,target=/webassembly

The current working directory is available on the container at ``/webassembly``.
